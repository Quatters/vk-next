(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{144:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(31),c=n.n(r),i=n(8),o=n.n(i),u=n(12),l=n(3),j=n(16),b=n(14),d=n(153),O=n(148),h=n(151),x=n(154),m=n(152),p=n(146),f=n(147),v=n(20),g=n.n(v),y="http://132.226.9.12";function C(e,t,n){return w.apply(this,arguments)}function w(){return(w=Object(u.a)(o.a.mark((function e(t,n,a){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||0,n=n||0,a=a||"",e.next=5,g.a.get(y+"/api/users?limit="+t+"&offset="+n+"&find="+a);case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return S.apply(this,arguments)}function S(){return(S=Object(u.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=n||0,e.next=3,g.a.get(y+"/api/users/"+t+"?limit="+n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){return L.apply(this,arguments)}function L(){return(L=Object(u.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.put(y+"/api/users/"+n+"?type=about",{about:t});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=Object(u.a)(o.a.mark((function e(t,n,a){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.put(y+"/api/users/"+a+"?type=name",{name:t,surname:n});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t){return B.apply(this,arguments)}function B(){return(B=Object(u.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.put(y+"/api/users/"+n+"?type=avatar",{avatar:t});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(u.a)(o.a.mark((function e(t,n,a){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.put(y+"/api/users/"+a+"/?type=password",{oldPassword:t,newPassword:n});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(u.a)(o.a.mark((function e(t,n,a){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post(y+"/api/users/"+a+"/posts",{name:n.name,surname:n.surname,avatarBase64:n.avatarBase64,login:n.login,body:t});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=Object(u.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.delete(y+"/api/users/"+n+"/posts/"+t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=Object(u.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post(y+"/api/login",{login:t,password:n});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post(y+"/api/register",{login:t.login,password:t.password,name:t.name,surname:t.surname});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return D.apply(this,arguments)}function D(){return(D=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.a.get(y+"/api/logout"),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=Object(a.createContext)({currentUser:null,refreshCurrentUser:function(e){}}),G=Object(a.createContext)({showNotification:function(e,t,n){}});function M(e){return e.length>0&&/^[a-z\u0430-\u044f-]+$/i.test(e)}function R(e){return e.length>=4}var V=n(1);function W(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],s=t[1],r=Object(a.useState)(""),c=Object(l.a)(r,2),i=c[0],o=c[1],u=Object(a.useState)(""),j=Object(l.a)(u,2),b=j[0],d=j[1],O=Object(a.useState)(""),v=Object(l.a)(O,2),g=v[0],y=v[1],C=Object(a.useState)(!1),w=Object(l.a)(C,2),N=w[0],S=w[1],k=Object(a.useState)(!1),L=Object(l.a)(k,2),T=L[0],U=L[1],B=Object(a.useState)(!1),H=Object(l.a)(B,2),z=H[0],E=H[1],I=Object(a.useState)(!1),P=Object(l.a)(I,2),D=P[0],M=P[1],W=Object(a.useState)(!0),$=Object(l.a)(W,2),_=$[0],J=$[1],K=Object(a.useContext)(A),Y=K.currentUser,Q=K.refreshCurrentUser,Z=Object(a.useContext)(G).showNotification,q=function(){return s(!1)};return Object(V.jsxs)(a.Fragment,{children:[Object(V.jsx)(h.a.Link,{to:"/users",className:"nav-link p-0",onClick:function(){return s(!0)},children:"Change password"}),Object(V.jsxs)(x.a,{show:n,onHide:q,children:[Object(V.jsx)(x.a.Header,{closeButton:!0,children:Object(V.jsx)(x.a.Title,{children:"Change password"})}),Object(V.jsx)(x.a.Body,{children:Object(V.jsxs)(m.a,{children:[Object(V.jsxs)(m.a.Group,{className:"mb-3 mt-0",children:[Object(V.jsx)(m.a.Label,{children:"Old password"}),Object(V.jsx)(m.a.Control,{type:"password",onChange:function(e){return o(e.target.value)}}),N&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"Wrong password"})]}),Object(V.jsxs)(m.a.Group,{className:"mb-3",children:[Object(V.jsx)(m.a.Label,{children:"New password"}),Object(V.jsx)(m.a.Control,{type:"password",onChange:function(e){return d(e.target.value)}}),T&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"At least 4 symbols"}),D&&!T&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"New and old passwords are the same"})]}),Object(V.jsxs)(m.a.Group,{className:"mb-3",children:[Object(V.jsx)(m.a.Label,{children:"Repeat new password"}),Object(V.jsx)(m.a.Control,{type:"password",onChange:function(e){return y(e.target.value)}}),z&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"Passwords don't match"})]})]})}),Object(V.jsxs)(x.a.Footer,{children:[Object(V.jsx)(p.a,{variant:"secondary",onClick:q,children:"Cancel"}),Object(V.jsx)(p.a,{variant:"primary",onClick:function(){(function(){var e=R(b),t=b===g,n=b!==i;return U(!e),E(!t),M(!n),S(!i),e&&t&&n&&i})()&&(J(!1),function(e,t,n){return F.apply(this,arguments)}(i,b,null===Y||void 0===Y?void 0:Y.login).then((function(e){Z(null,"Password has been changed.","Success"),q()})).catch((function(e){var t,n,a;403===(null===(t=e.response)||void 0===t?void 0:t.status)?Z(403):401===(null===(n=e.response)||void 0===n?void 0:n.status)?Z(401):404===(null===(a=e.response)||void 0===a?void 0:a.status)?S(!0):Z()})).finally((function(){J(!0),Q()})))},disabled:!_,children:_?"Confirm":Object(V.jsx)(f.a,{animation:"border",as:"span",size:"sm"})})]})]})]})}n(74);var $=n(29);function _(e){var t,n,s=Object(a.useState)(!1),r=Object(l.a)(s,2),c=r[0],i=r[1],o=function(){return i(!1)};return Object(V.jsxs)(a.Fragment,{children:[Object(V.jsx)(p.a,{variant:null!==(t=e.buttonVariant)&&void 0!==t?t:"primary",style:e.buttonStyle,onClick:function(){return i(!0)},children:e.openButtonText}),Object(V.jsxs)(x.a,{show:c,onHide:o,children:[Object(V.jsx)(x.a.Header,{closeButton:!0,children:Object(V.jsx)(x.a.Title,{children:null!==(n=e.title)&&void 0!==n?n:"Confirm action"})}),Object(V.jsx)(x.a.Body,{children:e.text}),Object(V.jsxs)(x.a.Footer,{children:[Object(V.jsx)(p.a,{variant:"secondary",onClick:o,children:"Cancel"}),Object(V.jsx)(p.a,{variant:"primary",onClick:function(){o(),e.confirmAction()},children:"Confirm"})]})]})]})}function J(){var e=Object(a.useContext)(A),t=e.currentUser,n=e.refreshCurrentUser,s=Object(b.k)();function r(){return(r=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:n(),s.push("/signin");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(V.jsx)("div",{children:Object(V.jsx)(d.a,{bg:"light",expand:"md",children:Object(V.jsxs)(O.a,{children:[Object(V.jsx)(d.a.Brand,{className:"ms-3",children:"VK Next"}),Object(V.jsx)(d.a.Toggle,{"aria-controls":"navbarScroll"}),Object(V.jsxs)(d.a.Collapse,{className:"pt-md-0 pt-2",children:[Object(V.jsx)(j.Link,{to:"/me",className:"nav-link show-on-sm",children:"My page"}),Object(V.jsx)(j.Link,{to:"/users",className:"nav-link show-on-sm",children:"Users"}),Object(V.jsx)("div",{className:"ms-auto ps-3 py-2",children:t&&Object(V.jsx)(W,{})}),t?Object(V.jsx)(h.a.Item,{className:"show-on-sm",children:Object(V.jsx)("div",{className:"d-flex",children:Object(V.jsx)(_,{openButtonText:"Sign Out",text:"Are you sure you want to leave your account?",confirmAction:function(){return r.apply(this,arguments)},buttonVariant:"link",buttonStyle:{textDecoration:"none",padding:"1rem",margin:"0",outline:"none !important"}})})}):Object(V.jsx)(h.a.Item,{className:"show-on-sm",children:Object(V.jsx)($.LinkContainer,{to:"/signin",children:Object(V.jsx)(h.a.Link,{children:"Sign In"})})})]})]})})})}var K=n(92),Y=n(156),Q=n.p+"static/media/default-avatar.522560c8.png",Z=n(95),q=(n(132),n(41)),X=n(42);function ee(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)(!1),i=Object(l.a)(c,2),j=i[0],b=i[1],d=Object(a.useState)(null),O=Object(l.a)(d,2),h=O[0],m=O[1],v=Object(a.useContext)(A),g=v.currentUser,y=v.refreshCurrentUser,C=Object(a.useContext)(G).showNotification,w=Object(a.useState)(!0),N=Object(l.a)(w,2),S=N[0],k=N[1],L=function(){return r(!1)};function T(){return(T=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!1),e.next=3,B(h.file);case 3:U(e.sent,g.login).then((function(e){L()})).catch((function(e){var t,n;403===(null===(t=e.response)||void 0===t?void 0:t.status)?C(403):401===(null===(n=e.response)||void 0===n?void 0:n.status)?C(401):C()})).finally((function(){k(!0),L(),y()}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return F.apply(this,arguments)}function F(){return(F=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new FileReader;a.onloadend=function(){e(a.result)},a.readAsDataURL(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(V.jsxs)(a.Fragment,{children:[Object(V.jsx)(p.a,{variant:"primary",onClick:function(){return r(!0)},className:"mt-3 w-100",children:"Edit"}),Object(V.jsxs)(x.a,{show:s,onHide:L,children:[Object(V.jsx)(x.a.Header,{closeButton:!0,children:Object(V.jsx)(x.a.Title,{children:"Edit avatar"})}),Object(V.jsxs)(x.a.Body,{children:[h?Object(V.jsx)("div",{className:"d-flex justify-content-center",children:Object(V.jsx)("img",{width:"200",src:h.preview,alt:"Avatar"})}):Object(V.jsx)("div",{className:"mb-2",children:Object(V.jsx)(Z.StyledDropZone,{onDrop:function(e,t){if((null===e||void 0===e?void 0:e.type)&&/^image\/.*$/.test(e.type)){var n=URL.createObjectURL(e);b(!1),m({file:e,preview:n})}else b(!0)},accept:"image/*"})}),j&&Object(V.jsx)("small",{className:"text-danger",children:"Invalid file format. Please, upload an image (.png, .jpg, etc)"})]}),Object(V.jsxs)(x.a.Footer,{className:"d-flex",children:[Object(V.jsx)(p.a,{variant:"danger",className:"me-auto",onClick:function(){k(!1),U("",g.login).then((function(e){y()})).catch((function(e){var t,n;403===(null===(t=e.response)||void 0===t?void 0:t.status)?C(403):401===(null===(n=e.response)||void 0===n?void 0:n.status)?C(401):C()})).finally((function(){k(!0),y(),L()}))},children:"Clear avatar"}),h&&Object(V.jsx)(p.a,{variant:"secondary",onClick:function(){m(null)},children:Object(V.jsx)(q.a,{icon:X.b})}),Object(V.jsx)(p.a,{variant:"primary",disabled:!h||!S,onClick:function(){return T.apply(this,arguments)},children:S?"Confirm":Object(V.jsx)(f.a,{animation:"border",as:"span",size:"sm"})})]})]})]})}function te(e){var t=Object(a.useContext)(A).currentUser,n=Object(a.useState)(!1),s=Object(l.a)(n,2),r=s[0],c=s[1];return Object(a.useEffect)((function(){c((null===t||void 0===t?void 0:t.login)===e.user.login)}),[e,t]),Object(V.jsx)(a.Fragment,{children:Object(V.jsx)(Y.a,{className:"mb-4",children:Object(V.jsxs)(Y.a.Body,{children:[Object(V.jsx)(Y.a.Img,{src:e.src||Q,variant:"top"}),r&&Object(V.jsx)(ee,{})]})})})}var ne=n(91);function ae(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)("What's new?"),i=Object(l.a)(c,2),o=i[0],u=i[1],j=Object(a.useContext)(A),d=j.currentUser,O=j.refreshCurrentUser,h=Object(b.k)(),x=Object(a.useState)(!0),m=Object(l.a)(x,2),v=m[0],g=m[1],y=Object(a.useState)(36),C=Object(l.a)(y,2),w=C[0],N=C[1],S=Object(a.useContext)(G).showNotification;return Object(a.useEffect)((function(){var e=function(){var e=h.location.pathname.split("/");return e[e.length-1]}();d?e!==d.login?u("Leave a post for @".concat(e)):e===d.login&&u("What's new?"):u("Please, authorize before leaving posts")}),[e]),Object(V.jsxs)("div",{className:"my-4 d-flex",children:[Object(V.jsx)(ne.a,{as:"textarea",style:{height:"".concat(w,"px"),resize:"none",overflow:"hidden"},placeholder:o,onChange:function(e){w<e.target.scrollHeight?N(w+24):w>e.target.scrollHeight&&N(w-24),r(e.target.value)},value:s,disabled:!d}),Object(V.jsx)(p.a,{onClick:function(){s.trim()&&(g(!1),function(e,t,n){return H.apply(this,arguments)}(s.trim(),d,e.user.login).then((function(t){(null===d||void 0===d?void 0:d.login)!==e.user.login?h.push("/users/"+e.user.login):O()})).catch((function(e){var t,n;O(),401===(null===(t=e.response)||void 0===t?void 0:t.status)?(S(401),h.push("/signin")):403===(null===(n=e.response)||void 0===n?void 0:n.status)?S(403):S()})).finally((function(){g(!0),r("")})))},className:"ms-3 align-self-end",disabled:!d||!v,children:v?"Post":Object(V.jsx)(f.a,{animation:"border",as:"span",size:"sm"})})]})}var se=n(65);function re(e){return Object(V.jsx)("img",{src:e.src||Q,alt:"Avatar",width:"50",height:"50",style:{borderRadius:"50%",cursor:"pointer",objectFit:"cover"},onClick:e.onClick})}var ce=n(96),ie=n.n(ce),oe=n(76),ue=n.n(oe);n(138);function le(e){var t,n=Object(b.k)(),s=Object(a.useState)(!1),r=Object(l.a)(s,2),c=r[0],i=r[1],o=Object(a.useContext)(A),u=o.currentUser,j=o.refreshCurrentUser,d=Object(a.useState)(!1),O=Object(l.a)(d,2),h=O[0],x=O[1],m=Object(a.useContext)(G).showNotification,p=Object(a.useState)(!0),v=Object(l.a)(p,2),g=v[0],y=v[1];function C(){n.push("/users/"+e.post.login)}function w(){if(!h)return x(!0),void setTimeout((function(){x(!1)}),3e3);x(!1),y(!1),function(e,t){return z.apply(this,arguments)}(e.post._id,u.login).catch((function(e){var t,a;401===(null===(t=e.response)||void 0===t?void 0:t.status)?(m(401),n.push("/signin")):403===(null===(a=e.response)||void 0===a?void 0:a.status)?m(403):m()})).finally((function(){j(e.postsLimit),e.setHasMoreData(!0),y(!0)}))}return ue()().locale("ru"),Object(a.useEffect)((function(){i((null===u||void 0===u?void 0:u.login)===function(){var e=n.location.pathname.split("/");return e[e.length-1]}())}),[e,u]),Object(V.jsx)(Y.a,{className:"mb-4",children:Object(V.jsxs)(Y.a.Body,{className:"d-flex flex-wrap",children:[Object(V.jsx)(re,{src:null!==(t=e.post.avatarBase64)&&void 0!==t?t:Q,onClick:C}),Object(V.jsxs)("div",{className:"d-flex flex-column",children:[Object(V.jsxs)("p",{className:"ms-3 mb-0",onClick:C,style:{cursor:"pointer"},children:[e.post.name," ",e.post.surname]}),Object(V.jsx)("small",{className:"ms-3 text-muted",children:Object(V.jsx)(ie.a,{fromNowDuring:1728e5,format:"lll",children:e.post.added})})]}),Object(V.jsxs)("div",{className:"ms-auto d-flex",children:[!g&&Object(V.jsx)(f.a,{className:"mt-1",animation:"border",as:"span",variant:"primary",size:"sm"}),h&&Object(V.jsx)("small",{className:"text-danger me-2",style:{cursor:"pointer"},onClick:w,children:"Delete?"}),c&&g&&Object(V.jsx)(se.a,{onClick:w})]}),Object(V.jsx)("div",{className:"w-100 mt-2"}),Object(V.jsx)(Y.a.Text,{style:{whiteSpace:"pre-line"},children:e.post.body})]})})}function je(e){var t;return Object(V.jsxs)("div",{className:"mt-4",children:[Object(V.jsx)(ae,{user:e.user}),null===(t=e.posts)||void 0===t?void 0:t.map((function(t){return Object(V.jsx)(le,{post:t,postsLimit:e.postsLimit,setHasMoreData:e.setHasMoreData},t._id)}))]})}function be(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)(""),i=Object(l.a)(c,2),o=i[0],u=i[1],j=Object(a.useState)(""),b=Object(l.a)(j,2),d=b[0],O=b[1],h=Object(a.useState)(!1),v=Object(l.a)(h,2),g=v[0],y=v[1],C=Object(a.useState)(!1),w=Object(l.a)(C,2),N=w[0],S=w[1],k=Object(a.useContext)(A).refreshCurrentUser,L=Object(a.useContext)(G).showNotification,U=function(){return r(!1)},B=Object(a.useState)(!0),F=Object(l.a)(B,2),H=F[0],z=F[1];return Object(V.jsxs)(a.Fragment,{children:[Object(V.jsx)(q.a,{icon:X.a,size:"sm",className:"text-primary",onClick:function(){return r(!0)},style:{cursor:"pointer"}}),Object(V.jsxs)(x.a,{show:s,onHide:U,children:[Object(V.jsx)(x.a.Header,{closeButton:!0,children:Object(V.jsx)(x.a.Title,{children:"Edit name"})}),Object(V.jsx)(x.a.Body,{children:Object(V.jsxs)(m.a,{children:[Object(V.jsxs)(m.a.Group,{className:"mb-3 mt-0",children:[Object(V.jsx)(m.a.Label,{children:"Name"}),Object(V.jsx)(m.a.Control,{onChange:function(e){return u(e.target.value)},placeholder:"Name"}),g&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"Cannot be empty, may contain only letters and dash"})]}),Object(V.jsxs)(m.a.Group,{className:"mb-3",children:[Object(V.jsx)(m.a.Label,{children:"Last name"}),Object(V.jsx)(m.a.Control,{onChange:function(e){return O(e.target.value)},placeholder:"Last name"}),N&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"Cannot be empty, may contain only letters and dash"})]})]})}),Object(V.jsxs)(x.a.Footer,{children:[Object(V.jsx)(p.a,{variant:"secondary",onClick:U,children:"Cancel"}),Object(V.jsx)(p.a,{variant:"primary",onClick:function(){(function(){var e=M(o),t=M(d);return y(!e),S(!t),e&&t})()&&(z(!1),function(e,t,n){return T.apply(this,arguments)}(o,d,e.user.login).then((function(e){U()})).catch((function(e){var t,n;403===(null===(t=e.response)||void 0===t?void 0:t.status)?L(403):401===(null===(n=e.response)||void 0===n?void 0:n.status)?L(401):L()})).finally((function(){z(!0),k(),U()})))},disabled:!H,children:H?"Confirm":Object(V.jsx)(f.a,{animation:"border",as:"span",size:"sm"})})]})]})]})}function de(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)(""),i=Object(l.a)(c,2),j=i[0],b=i[1],d=Object(a.useContext)(A).refreshCurrentUser,O=Object(a.useContext)(G).showNotification,h=Object(a.useState)(!0),v=Object(l.a)(h,2),g=v[0],y=v[1],C=function(){return r(!1)};function w(){return(w=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:y(!1),k(j.trim(),e.user.login).then((function(e){C()})).catch((function(e){var t,n;403===(null===(t=e.response)||void 0===t?void 0:t.status)?O(403):401===(null===(n=e.response)||void 0===n?void 0:n.status)?O(401):O()})).finally((function(){y(!0),d(),C()}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(V.jsxs)(a.Fragment,{children:[Object(V.jsx)(q.a,{icon:X.a,size:"xs",className:"text-primary",onClick:function(){return r(!0)},style:{cursor:"pointer"}}),Object(V.jsxs)(x.a,{show:s,onHide:C,children:[Object(V.jsx)(x.a.Header,{closeButton:!0,children:Object(V.jsx)(x.a.Title,{children:"Edit status"})}),Object(V.jsx)(x.a.Body,{children:Object(V.jsx)(m.a,{children:Object(V.jsx)(m.a.Control,{onChange:function(e){return b(e.target.value)},placeholder:"Status",autoFocus:!0})})}),Object(V.jsxs)(x.a.Footer,{children:[Object(V.jsx)(p.a,{variant:"secondary",onClick:C,children:"Cancel"}),Object(V.jsx)(p.a,{variant:"primary",onClick:function(){return w.apply(this,arguments)},disabled:!g,children:g?"Confirm":Object(V.jsx)(f.a,{animation:"border",as:"span",size:"sm"})})]})]})]})}function Oe(e){var t=Object(a.useContext)(A).currentUser,n=Object(a.useState)(!1),s=Object(l.a)(n,2),r=s[0],c=s[1];return Object(a.useEffect)((function(){c((null===t||void 0===t?void 0:t.login)===e.user.login)}),[e,t]),Object(V.jsx)(Y.a,{children:Object(V.jsxs)(Y.a.Body,{className:"d-flex flex-wrap overflow-hidden",children:[Object(V.jsxs)(Y.a.Title,{className:"mb-1",children:[e.user.name," ",e.user.surname]}),r&&Object(V.jsx)("div",{className:"ms-2 align-self-start",children:Object(V.jsx)(be,{user:e.user})}),Object(V.jsx)("div",{className:"w-100 mb-2"}),Object(V.jsx)(Y.a.Text,{className:"mb-0",children:e.user.about||r&&"Set status..."}),r&&Object(V.jsx)("div",{className:"ms-2 align-self-start",children:Object(V.jsx)(de,{user:e.user})})]})})}var he=n(67);function xe(e){var t=Object(a.useState)(null),n=Object(l.a)(t,2),s=n[0],r=n[1],c=Object(a.useContext)(G).showNotification,i=Object(a.useContext)(A),o=i.currentUser,u=(i.refreshCurrentUser,Object(a.useState)(!1)),j=Object(l.a)(u,2),d=j[0],O=j[1],h=Object(b.k)(),x=Object(a.useState)(10),m=Object(l.a)(x,2),p=m[0],v=m[1],g=Object(a.useState)(!0),y=Object(l.a)(g,2),C=y[0],w=y[1];return Object(a.useEffect)((function(){v(10);var t=function(){var t=e.location.pathname.split("/");return t[t.length-1]}();"me"===t.toLowerCase()&&o?h.replace("/users/"+o.login):N(t,p).then((function(e){w(e.data.totalPostsLength!==e.data.posts.length),r(e.data)})).catch((function(e){var t,n;401===(null===(t=e.response)||void 0===t?void 0:t.status)?(c(401),h.push("/signin")):404===(null===(n=e.response)||void 0===n?void 0:n.status)?c(null,"User not found.","Error"):c()})).finally((function(){O(!0)}))}),[e.location,o]),s?Object(V.jsxs)(a.Fragment,{children:[Object(V.jsx)(K.a,{sm:4,md:3,children:Object(V.jsx)(te,{src:s.avatarBase64,user:s})}),Object(V.jsxs)(K.a,{sm:8,md:7,children:[Object(V.jsx)(Oe,{user:s}),Object(V.jsx)(je,{user:s,posts:s.posts,postsLimit:p,setHasMoreData:w}),Object(V.jsx)(he.a,{dataLength:s.posts.length,next:function(){!function(e,t){if(!t)return;N(s.login,e).then((function(e){var t,n,a;w((null===s||void 0===s||null===(t=s.posts)||void 0===t?void 0:t.length)!==(null===(n=e.data)||void 0===n||null===(a=n.posts)||void 0===a?void 0:a.length)),r(e.data)})).catch((function(e){w(!1),c()}))}(p+10,C),v(p+10)},hasMore:C,scrollThreshold:.82,loader:Object(V.jsx)("div",{className:"d-flex mt-3 mb-5 justify-content-center",children:Object(V.jsx)(f.a,{animation:"border",variant:"primary"})})})]})]}):d?null:Object(V.jsx)(K.a,{className:"d-flex justify-content-center",children:Object(V.jsx)(f.a,{animation:"border",variant:"primary"})})}var me=n(149),pe=n(150);function fe(){var e=Object(b.k)(),t=Object(a.useContext)(A),n=t.currentUser,s=t.refreshCurrentUser;function r(){return(r=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P();case 2:s(),e.push("/signin");case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(V.jsx)(K.a,{sm:3,md:2,className:"hide-on-sm",children:Object(V.jsxs)(h.a,{className:"flex-column",variant:"",children:[Object(V.jsx)(h.a.Item,{children:Object(V.jsx)($.LinkContainer,{to:"/me",children:Object(V.jsx)(h.a.Link,{children:"My page"})})}),Object(V.jsx)(h.a.Item,{children:Object(V.jsx)($.LinkContainer,{to:"/users",children:Object(V.jsx)(h.a.Link,{children:"Users"})})}),n?Object(V.jsx)(h.a.Item,{className:"mt-2",children:Object(V.jsx)("div",{className:"d-flex",children:Object(V.jsx)(_,{openButtonText:"Sign Out",text:"Are you sure you want to leave your account?",confirmAction:function(){return r.apply(this,arguments)},buttonVariant:"link",buttonStyle:{textDecoration:"none",padding:"1rem",margin:"0",outline:"none !important"}})})}):Object(V.jsx)(h.a.Item,{className:"mt-3",children:Object(V.jsx)($.LinkContainer,{to:"/signin",children:Object(V.jsx)(h.a.Link,{children:"Sign In"})})})]})})}function ve(){var e=Object(b.k)(),t=Object(a.useState)(""),n=Object(l.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)(""),i=Object(l.a)(c,2),o=i[0],u=i[1],j=Object(a.useState)(!1),d=Object(l.a)(j,2),O=d[0],h=d[1],x=Object(a.useState)(!0),v=Object(l.a)(x,2),g=v[0],y=v[1],C=Object(a.useContext)(A).refreshCurrentUser,w=Object(a.useContext)(G).showNotification;return Object(V.jsx)(Y.a,{className:"mb-4",children:Object(V.jsxs)(Y.a.Body,{children:[Object(V.jsx)(Y.a.Title,{className:"mb-2",children:"Sign In"}),O&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"Wrong login or password."}),Object(V.jsxs)(m.a,{className:"mt-3",children:[Object(V.jsx)(m.a.Control,{placeholder:"Login",className:"mb-3",onChange:function(e){return r(e.target.value)}}),Object(V.jsx)(m.a.Control,{type:"password",placeholder:"Password",className:"mb-3",onChange:function(e){return u(e.target.value)}}),Object(V.jsx)(p.a,{variant:"primary",onClick:function(){y(!1),function(e,t){return E.apply(this,arguments)}(s,o).then((function(t){N(s).then((function(t){y(!0),C(),e.push("/me")}))})).catch((function(e){var t;y(!0),404===(null===(t=e.response)||void 0===t?void 0:t.status)?h(!0):w()}))},disabled:!g,children:g?"Submit":Object(V.jsx)(f.a,{animation:"border",as:"span",size:"sm"})})]})]})})}function ge(){return Object(V.jsx)(Y.a,{children:Object(V.jsxs)(Y.a.Body,{children:[Object(V.jsx)(Y.a.Title,{children:"To use VK Next please sign in."}),Object(V.jsx)($.LinkContainer,{to:"/signin",children:Object(V.jsx)("div",{children:Object(V.jsx)(p.a,{className:"mt-1",children:"Sign In"})})}),Object(V.jsx)(Y.a.Title,{className:"mt-4",children:"Do not have an account?"}),Object(V.jsx)($.LinkContainer,{to:"/signup",children:Object(V.jsx)("div",{children:Object(V.jsx)(p.a,{className:"mt-1",children:"Sign Up"})})})]})})}function ye(){return Object(a.useContext)(A).currentUser?Object(V.jsx)(b.c,{to:"/me"}):Object(V.jsxs)(a.Fragment,{children:[Object(V.jsx)(K.a,{sm:6,md:5,lg:4,children:Object(V.jsx)(ve,{})}),Object(V.jsx)(K.a,{sm:6,md:4,lg:5,children:Object(V.jsx)(ge,{})})]})}function Ce(){var e=Object(b.k)(),t=Object(a.useState)(""),n=Object(l.a)(t,2),s=n[0],r=n[1],c=Object(a.useState)(""),i=Object(l.a)(c,2),o=i[0],u=i[1],j=Object(a.useState)(""),d=Object(l.a)(j,2),O=d[0],h=d[1],x=Object(a.useState)(""),v=Object(l.a)(x,2),g=v[0],y=v[1],C=Object(a.useState)(""),w=Object(l.a)(C,2),N=w[0],S=w[1],k=Object(a.useState)(!1),L=Object(l.a)(k,2),T=L[0],U=L[1],B=Object(a.useState)(!1),F=Object(l.a)(B,2),H=F[0],z=F[1],E=Object(a.useState)(!1),P=Object(l.a)(E,2),D=P[0],A=P[1],G=Object(a.useState)(!1),W=Object(l.a)(G,2),$=W[0],_=W[1],J=Object(a.useState)(!1),K=Object(l.a)(J,2),Q=K[0],Z=K[1],q=Object(a.useState)(!1),X=Object(l.a)(q,2),ee=X[0],te=X[1],ne=Object(a.useState)(!0),ae=Object(l.a)(ne,2),se=ae[0],re=ae[1];return Object(V.jsx)(Y.a,{children:Object(V.jsxs)(Y.a.Body,{children:[Object(V.jsx)(Y.a.Title,{children:"Sign Up"}),Object(V.jsxs)(m.a,{className:"mt-4",children:[Object(V.jsxs)(m.a.Group,{className:"mb-3",children:[Object(V.jsx)(m.a.Label,{children:"Name"}),Object(V.jsx)(m.a.Control,{onChange:function(e){return r(e.target.value)}}),T&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"Cannot be empty, may contain only letters and dash"})]}),Object(V.jsxs)(m.a.Group,{className:"mb-3",children:[Object(V.jsx)(m.a.Label,{children:"Last name"}),Object(V.jsx)(m.a.Control,{onChange:function(e){return u(e.target.value)}}),H&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"Cannot be empty, may contain only letters and dash"})]}),Object(V.jsxs)(m.a.Group,{className:"mb-3",children:[Object(V.jsx)(m.a.Label,{children:"Login"}),Object(V.jsx)(m.a.Control,{onChange:function(e){return h(e.target.value)}}),D&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"At least 4 symbols, may contain letters, numbers and dash"}),ee&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"This login is already in use"})]}),Object(V.jsxs)(m.a.Group,{className:"mb-3",children:[Object(V.jsx)(m.a.Label,{children:"Password"}),Object(V.jsx)(m.a.Control,{type:"password",onChange:function(e){return y(e.target.value)}}),$&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"At least 4 symbols"})]}),Object(V.jsxs)(m.a.Group,{className:"mb-3",children:[Object(V.jsx)(m.a.Label,{children:"Repeat password"}),Object(V.jsx)(m.a.Control,{type:"password",onChange:function(e){return S(e.target.value)}}),Q&&Object(V.jsx)(m.a.Text,{className:"text-danger",children:"Passwords don't match"})]}),Object(V.jsx)(p.a,{variant:"primary",onClick:function(){re(!1),function(){var e=M(s),t=M(o),n=function(e){return e.length>=4&&/^[a-z0-9-]+$/i.test(e)}(O),a=R(g),r=g===N;return U(!e),z(!t),A(!n),_(!a),Z(!r),e&&t&&n&&a&&r}()&&function(e){return I.apply(this,arguments)}({name:s,surname:o,login:O,password:g}).then((function(t){e.push("/signin")})).catch((function(e){var t;400===(null===(t=e.response)||void 0===t?void 0:t.status)&&te(!0)})).finally((function(){re(!0)}))},disabled:!se,children:se?"Submit":Object(V.jsx)(f.a,{animation:"border",as:"span",size:"sm"})})]})]})})}function we(){return Object(a.useContext)(A).currentUser?Object(V.jsx)(b.c,{to:"/me"}):Object(V.jsxs)(a.Fragment,{children:[Object(V.jsx)(K.a,{sm:6,md:5,lg:4,children:Object(V.jsx)(Ce,{})}),Object(V.jsx)(K.a,{sm:3,md:4,lg:5,children:Object(V.jsx)(ge,{})})]})}function Ne(e){var t;return Object(V.jsx)($.LinkContainer,{to:"/users/"+e.user.login,children:Object(V.jsx)(Y.a,{className:"mb-4 user-small",children:Object(V.jsxs)(Y.a.Body,{className:"d-flex flex-wrap",children:[Object(V.jsx)(re,{src:(null===(t=e.user)||void 0===t?void 0:t.avatarBase64)||Q}),Object(V.jsxs)("div",{className:"d-flex flex-column align-self-center",children:[Object(V.jsxs)("p",{className:"ms-3 mb-0",children:[e.user.name," ",e.user.surname]}),Object(V.jsx)("small",{className:"ms-3",children:e.user.about})]})]})})})}function Se(e){return Object(V.jsx)(a.Fragment,{children:e.users.map((function(e){return Object(V.jsx)(Ne,{user:e},e._id)}))})}function ke(e){var t=Object(a.useState)(null),n=Object(l.a)(t,2),s=n[0],r=n[1];return Object(V.jsxs)("div",{className:"mb-3",children:[Object(V.jsx)(m.a.Control,{placeholder:"Search for user...",onChange:function(t){s&&(clearInterval(s),r(null));var n=setTimeout((function(){e.onSearch(t.target.value)}),600);r(n)}}),Object(V.jsx)(m.a.Text,{className:"ms-1",children:"Use @ for search by login (e.g. @Quatters) or just type a name"})]})}function Le(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),n=t[0],s=t[1],r=Object(a.useContext)(G).showNotification,c=Object(a.useState)(10),i=Object(l.a)(c,2),o=i[0],u=i[1],j=Object(a.useState)(!0),b=Object(l.a)(j,2),d=b[0],O=b[1];function h(e,t){t&&C(e).then((function(e){O(e.data.users.length!==e.data.totalUsers),s(e.data.users)})).catch((function(e){O(!1),r()}))}return Object(a.useEffect)((function(){h(o,d)}),[]),Object(V.jsxs)(K.a,{children:[Object(V.jsx)(ke,{className:"mb-4",onSearch:function(e){if(O(!e),!e||""===e)return u(10),O(!0),void h(10,!0);C(50,0,e.trim()).then((function(e){s(e.data.users)})).catch((function(e){O(!1),r()}))}}),Object(V.jsx)(Se,{users:n}),Object(V.jsx)(he.a,{dataLength:n.length,next:function(){h(o+10,d),u(o+10)},hasMore:d,scrollThreshold:.82,loader:Object(V.jsx)("div",{className:"d-flex mt-3 mb-5 justify-content-center",children:Object(V.jsx)(f.a,{animation:"border",variant:"primary"})})})]})}var Te=n(155);function Ue(e){var t=Object(a.useState)(e.show),n=Object(l.a)(t,1)[0];return Object(V.jsxs)(Te.a,{show:e.show||n,onClose:e.toggleShow,children:[Object(V.jsx)(Te.a.Header,{children:Object(V.jsx)("strong",{className:"me-auto",children:e.headerText})}),Object(V.jsx)(Te.a.Body,{children:e.text})]})}function Be(){return Object(V.jsx)(b.c,{to:"/signin"})}n(139).config(),g.a.defaults.withCredentials=!0;var Fe=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],s=t[1],r=Object(a.useState)(!1),c=Object(l.a)(r,2),i=c[0],d=c[1],h=Object(a.useState)(!1),x=Object(l.a)(h,2),m=x[0],p=x[1],v=Object(a.useState)(""),g=Object(l.a)(v,2),y=g[0],C=g[1],w=Object(a.useState)(""),S=Object(l.a)(w,2),k=S[0],L=S[1];Object(a.useEffect)((function(){N("me",10).then((function(e){s(e.data)})).catch((function(e){})).finally((function(){d(!0)}))}),[]);var T=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null!==(n=t)&&void 0!==n?n:10,e.next=3,N("me",t).then((function(e){s(e.data)})).catch((function(e){var t;U(null===(t=e.response)||void 0===t?void 0:t.status),s(null)})).finally((function(){d(!0)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e,t,n){e?(L("Error"),403===e?C("You are not allowed to modify this user."):401===e&&C("You are not authorized.")):t?(C(t),L(n)):(C("Unknown error."),L("Error")),p(!0),setTimeout((function(){p(!1)}),5200)};return n||i?Object(V.jsx)(j.BrowserRouter,{children:Object(V.jsx)(A.Provider,{value:{currentUser:n,refreshCurrentUser:T},children:Object(V.jsxs)(G.Provider,{value:{showNotification:U},children:[Object(V.jsx)(me.a,{className:"p-4 notification-container position-fixed",style:{zIndex:"100"},position:"bottom-end",children:Object(V.jsx)(Ue,{headerText:k,text:y,show:m,toggleShow:function(){return p(!m)}})}),Object(V.jsx)(J,{}),Object(V.jsx)(O.a,{className:"mt-4",children:Object(V.jsxs)(pe.a,{children:[Object(V.jsx)(fe,{}),Object(V.jsxs)(b.g,{children:[Object(V.jsx)(b.d,{exact:!0,path:"/",component:Be}),Object(V.jsx)(b.d,{exact:!0,path:"/me",component:xe}),Object(V.jsx)(b.d,{exact:!0,path:"/users/:login",component:xe}),Object(V.jsx)(b.d,{exact:!0,path:"/users",component:Le}),Object(V.jsx)(b.d,{exact:!0,path:"/signin",component:ye}),Object(V.jsx)(b.d,{exact:!0,path:"/signup",component:we})]})]})})]})})}):Object(V.jsx)("div",{className:"d-flex justify-content-center mt-5 pt-5",children:Object(V.jsx)(f.a,{animation:"border",variant:"primary"})})};n(143);c.a.render(Object(V.jsx)(s.a.StrictMode,{children:Object(V.jsx)(Fe,{})}),document.getElementById("root"))},74:function(e,t,n){}},[[144,1,2]]]);
//# sourceMappingURL=main.1c509d28.chunk.js.map